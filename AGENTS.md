# LonelyCat Agent Instructions

> **Generated from**: `agent/` cognition layer
> **Last Updated**: 2026-02-09 19:12:00
> **[WARN]ï¸ DO NOT EDIT THIS FILE MANUALLY** - Edit `agent/*` and regenerate

---

## ðŸŽ¯ Project Overview

**Name**: LonelyCat
**Tagline**: Self-Evolving Local AgentOS
**Phase**: Phase 0 - Cognitive Layer
**Status**: active_development

**Primary Objective**: Build a local-first AI agent platform that can understand, modify, and evolve itself

---

## ðŸ—ï¸ Architecture (5 Layers)

## ðŸŽ¯ LAYERS: 5-Tier Architecture


---

## ðŸš« FORBIDDEN PATHS (Never Modify)

```yaml
- .git/**
- .gitignore
- .env
- .env.*
- '**/*.pem'
- '**/*.key'
- '**/credentials.*'
- '**/secrets.*'
- node_modules/**
- .venv/**
- .venv-dev/**
- '**/__pycache__/**'
- '**/dist/**'
- '**/build/**'
- '*.lock'
- pnpm-lock.yaml
- package-lock.json
- poetry.lock
- Pipfile.lock
- agent/policies/default.yaml
- agent/policies/security_boundaries.md

```

**Violation**: Immediate abort + audit log

---

## âœ… WRITE-ALLOWED PATHS

```yaml
- workspace/**
- .pids/**
- '*.log'
- .pytest_cache/**
- htmlcov/**
- '**/*.pyc'
- AGENTS.md
- CLAUDE.md
- .cursor/rules/**

```

---

## âš–ï¸ RISK LEVELS

### L0 - Read Only (No Approval)
- web.search, web.fetch, memory.list_facts
- read_file, list_directory

### L1 - Write (Approval Required in Phase 0)
- memory.propose, skill.python.run
- write_file, create_directory

### L2 - Execute (Always Requires Approval)
- host.execute_command, host.apply_patch
- execute_shell, modify_database

### L3 - Destructive (Double Confirmation)
- host.delete_database, git.reset_hard
- drop_table, delete_branch

---

## ðŸ“‹ WRITEGATE RULES (Phase 1+)

**When Required**:
- Modifying `apps/**/*.py`, `packages/**/*.py`
- Changing `pyproject.toml`, `package.json`
- Any code/config modification

**Flow**:
1. Create **ChangePlan** (objective, affected_files, risk, rollback)
2. User approves plan
3. Generate **ChangeSet** (diffs)
4. User approves diffs
5. Apply atomically
6. Verify (tests pass)
7. Record in audit

---

## ðŸ” HOW TO QUERY

### Find Code
```python
# Use Grep for patterns
Grep(pattern="accept_proposal", path="packages/memory")

# Or read architecture docs
Read agent/architecture.md -> "Where to Find Things"
```

### Check Permissions
1. Check `forbidden_paths` -> If match, ABORT
2. Check `read_only_paths` -> Need approval
3. Check `risk_levels` -> Determine approval requirement
4. Check `writegate_rules` -> Generate ChangePlan if needed

### Propose Changes
```
Phase 0: Explain what should change (cannot modify directly)
Phase 1+: Create ChangePlan -> User approval -> Apply via WriteGate
```

---

## ðŸŽ“ MEMORY LIFECYCLE

```
Proposal (pending)
    â†“ (confidence >= 0.85 + AUTO_ACCEPT=1)
    â†“ OR manual approval
Fact (active)
    â†“ (revoke/archive)
Fact (inactive)
    â†“ (reactivate)
Fact (active)
```

**Conflict Resolution**:
- Single-value keys -> **overwrite_latest**
- Multi-value keys (ends with `[]`) -> **keep_both**

---

## ðŸš¨ SAFETY BOUNDARIES (Immutable)

From `agent/policies/default.yaml` -> security_boundaries:

1. **Cannot modify policies file itself** (agent/policies/default.yaml)
2. **Cannot bypass WriteGate** (all code changes must be reviewed)
3. **Cannot disable audit logging**
4. **Cannot expose secrets in logs**
5. **Skills must run with --network=none** (Phase 1)

**Exception**: Explicit user command only

---

## ðŸ’¡ BEST PRACTICES

### DO:
- âœ… Read architecture docs before asking
- âœ… Check policies before acting
- âœ… Generate ChangePlan for code mods
- âœ… Cite sources ("From agent/architecture.md...")
- âœ… Explain reasoning with confidence scores

### DON'T:
- âŒ Modify forbidden_paths
- âŒ Bypass WriteGate
- âŒ Make assumptions (verify with docs)
- âŒ Edit projections manually (regenerate instead)

---

## ðŸ“š WORKFLOWS (Example Patterns)

Available workflows in `agent/workflows/`:
- `add_web_provider.md` - Add new search backend
- `debug_memory_issue.md` - Diagnose memory problems
- `self_improvement_proposal.md` - Propose AI improvements

**Note**: Workflows are **reference patterns**, not strict instructions. Adapt based on context.

---

## ðŸ”— FURTHER READING

- **Project Goals**: `agent/project.md`
- **Architecture Deep Dive**: `agent/architecture.md`
- **Complete Policies**: `agent/policies/default.yaml`
- **Workflows**: `agent/workflows/*.md`

---

**Projection Source**: agent/ cognition layer
**Regenerate**: `python scripts/generate_projections.py`
**Modification Protocol**: Edit agent/ -> Regenerate projections
