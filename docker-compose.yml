# LonelyCat â€” Docker Compose for quick start (Linux / WSL / PowerShell).
# Uses SQLite by default; no Postgres/Redis required.
# Optional: copy .env.example to .env for overrides.

services:
  core-api:
    build:
      context: .
      dockerfile: apps/core-api/Dockerfile
    container_name: lonelycat-core-api
    ports:
      - "5173:5173"
    environment:
      - LONELYCAT_MEMORY_DB_URL=sqlite:////app/data/lonelycat_memory.db
      - LONELYCAT_CORE_API_DB_URL=sqlite:////app/data/lonelycat_memory.db
    volumes:
      - ./data:/app/data
    restart: unless-stopped

  agent-worker:
    build:
      context: .
      dockerfile: apps/agent-worker/Dockerfile
    container_name: lonelycat-agent-worker
    depends_on:
      - core-api
    environment:
      - LONELYCAT_MEMORY_DB_URL=sqlite:////app/data/lonelycat_memory.db
      - LONELYCAT_CORE_API_DB_URL=sqlite:////app/data/lonelycat_memory.db
    volumes:
      - ./data:/app/data
    restart: unless-stopped

  web-console:
    build:
      context: .
      dockerfile: apps/web-console/Dockerfile
    container_name: lonelycat-web-console
    ports:
      - "8000:8000"
    depends_on:
      - core-api
    environment:
      # Vite dev server proxies /api to core-api container
      - VITE_CORE_API_URL=http://core-api:5173
    restart: unless-stopped
